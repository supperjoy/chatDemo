---
import Layout from "../layouts/Layout.astro";
import Commodity from "./Commodity.astro";
---

<Layout title="Password Protection">
  <main class="h-screen col-fcc">
    <pay></pay>
    <div class="box h-screen">
      <ul id="list">
        <!-- <li>
          <img src="https://supperjoy-1311200541.cos.ap-chengdu.myqcloud.com/%E5%95%86%E5%93%81.png" alt="" class="img">
          <div class="info">
            <div id="productName">国内免梯子chatgpt月包国内</div>
            <div id="money">￥9.99</div>
            <div id="description">
              国内免梯子chatgpt月包国内免梯子chatgpt月包国内免梯子chatgpt
            </div>
          </div>
        </li> -->
      </ul>
    </div>
  </main>
</Layout>

<script>
  import axios from "axios";

  axios({
    method: "get",
    url: "https://test.supperjoy.online/commodity",
    withCredentials: true,
  }).then((res) => {
    console.log(res);
    if (res.data.code == 200) {
      const products = res.data.data;
      const list = document.querySelector("#list");
      products.forEach((product) => {
        const li = document.createElement("li");
        const div = document.createElement("div");
        const productNameDiv = document.createElement("div");
        const moneyDiv = document.createElement("div");
        const descriptionDiv = document.createElement("div");
        const img = document.createElement("img");
        img.src = "https://supperjoy-1311200541.cos.ap-chengdu.myqcloud.com/%E5%95%86%E5%93%81.png"
        img.classList.add("astro-KAO5JSLF")
        img.classList.add("img")

        productNameDiv.innerText = product.productName;
        moneyDiv.innerText = "￥" + product.money;
        descriptionDiv.innerText = product.description;

        productNameDiv.id = "productName";
        productNameDiv.classList.add("astro-KAO5JSLF");
        moneyDiv.id = "money";
        moneyDiv.classList.add("astro-KAO5JSLF");
        descriptionDiv.id = "description";
        descriptionDiv.classList.add("astro-KAO5JSLF");

        document.createElement("Commodity");
        li.appendChild(img);
        div.appendChild(productNameDiv);
        div.appendChild(moneyDiv);
        div.appendChild(descriptionDiv);
        li.appendChild(div);
        li.dataset.id = product.id;
        list.appendChild(li);
        div.classList.add("info");
        div.classList.add("astro-KAO5JSLF");
        li.classList.add("astro-KAO5JSLF");
      });
      list.addEventListener("click", (event) => {
        const li = event.target.closest("li");
        const id = li.dataset.id;
        window.location.href = '/paying?commodityId=' + id;
      });
    }
  });
</script>

<style>
  .box {
    width: 400px;
    /* height: 400px; */
    /* background-color: #fff; */
    border-radius: 10px;
  }
  ul li {
    width: 100%;
    height: 100px;
    background-color: #fff;
    border-radius: 10px;
    box-shadow: 0 0 10px 0 rgba(0, 0, 0, 0.1);
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    box-shadow: 18px 18px 30px rgba(0, 0, 0, 0.05);
    transition: all 0.1s ease-out;
    padding-left: 10px;
  }

  ul li:hover {
    cursor: pointer;
    transform: scale(1.05);
  }

  .info {
    color: #4a576a;
    margin-left: 15px;
  }

  #productName {
    width: 250px;
    font-size: 16px;
    font-weight: 700;
    color: #4a576a;
    white-space: nowrap; /*不允许自动换行*/
    overflow: hidden; /*溢出隐藏*/
    text-overflow: ellipsis; /*超出部分显示省略号*/
  }

  #description {
    width: 250px;
    font-size: 12px;
    color: #9ca3af;
    white-space: nowrap; /*不允许自动换行*/
    overflow: hidden; /*溢出隐藏*/
    text-overflow: ellipsis; /*超出部分显示省略号*/
  }
  .img{
    width: 80px;
    height:80px;
  }
</style>
